<!DOCTYPE html>
<html lang="th-TH">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ใช้งาน DB Seeder และ Model Factory | tutor4dev</title>
    <meta name="description" content="คอร์สอบรม, บทความ และคลิปวีดีโอการพัฒนาเว็บแอพพลิเคชั่น - ใช้งาน DB Seeder และ Model Factory">
    <meta property="og:locale" content="th_TH">
  <meta property="og:type" content="article">
  <link rel="icon" href="/favicon.ico">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Kanit|Source+Code+Pro">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <link rel="preload" href="/assets/css/0.styles.85503cd0.css" as="style"><link rel="preload" href="/assets/js/app.348c05a1.js" as="script"><link rel="preload" href="/assets/js/15.4a80a520.js" as="script"><link rel="prefetch" href="/assets/js/10.19a93195.js"><link rel="prefetch" href="/assets/js/11.4839b2c5.js"><link rel="prefetch" href="/assets/js/12.43d3d9bc.js"><link rel="prefetch" href="/assets/js/13.c6b0273a.js"><link rel="prefetch" href="/assets/js/14.99e5612b.js"><link rel="prefetch" href="/assets/js/16.9d03883d.js"><link rel="prefetch" href="/assets/js/17.85020c52.js"><link rel="prefetch" href="/assets/js/18.91398a1f.js"><link rel="prefetch" href="/assets/js/19.f9a96888.js"><link rel="prefetch" href="/assets/js/2.094bf6d7.js"><link rel="prefetch" href="/assets/js/20.a9690ebf.js"><link rel="prefetch" href="/assets/js/21.a00a77fa.js"><link rel="prefetch" href="/assets/js/22.562990d5.js"><link rel="prefetch" href="/assets/js/23.8fc29c26.js"><link rel="prefetch" href="/assets/js/24.de3da9f4.js"><link rel="prefetch" href="/assets/js/25.0472472d.js"><link rel="prefetch" href="/assets/js/26.8f474f06.js"><link rel="prefetch" href="/assets/js/27.f917ef5f.js"><link rel="prefetch" href="/assets/js/28.8896a162.js"><link rel="prefetch" href="/assets/js/29.ca7dd98c.js"><link rel="prefetch" href="/assets/js/3.8d44adec.js"><link rel="prefetch" href="/assets/js/30.5f27648e.js"><link rel="prefetch" href="/assets/js/31.24ff45da.js"><link rel="prefetch" href="/assets/js/32.14e108ad.js"><link rel="prefetch" href="/assets/js/33.8b0a7ee8.js"><link rel="prefetch" href="/assets/js/34.29965b58.js"><link rel="prefetch" href="/assets/js/35.306b0931.js"><link rel="prefetch" href="/assets/js/36.9ffa675d.js"><link rel="prefetch" href="/assets/js/37.8d1a2077.js"><link rel="prefetch" href="/assets/js/38.8e1ac153.js"><link rel="prefetch" href="/assets/js/39.296618eb.js"><link rel="prefetch" href="/assets/js/4.e59ffa50.js"><link rel="prefetch" href="/assets/js/40.1f4572a5.js"><link rel="prefetch" href="/assets/js/41.2587529b.js"><link rel="prefetch" href="/assets/js/42.db9edad2.js"><link rel="prefetch" href="/assets/js/43.e92e326a.js"><link rel="prefetch" href="/assets/js/44.ce1b378e.js"><link rel="prefetch" href="/assets/js/45.95e15a8d.js"><link rel="prefetch" href="/assets/js/5.cf11d61b.js"><link rel="prefetch" href="/assets/js/6.0d36f759.js"><link rel="prefetch" href="/assets/js/7.46d53fd4.js"><link rel="prefetch" href="/assets/js/8.4f2d32ba.js"><link rel="prefetch" href="/assets/js/9.2615014a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.85503cd0.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div><!----> <nav role="navigation" aria-label="main navigation" class="navbar" data-v-0b4010bb><div class="navbar-brand" style="margin-left:2em;" data-v-0b4010bb><a href="https://twitter.com/tutor4dev" target="_blank" class="navbar-item is-hidden-desktop" data-v-0b4010bb><span class="icon" style="color:#55acee;" data-v-0b4010bb><i class="fa fa-lg fa-twitter" data-v-0b4010bb></i></span></a><a href="https://fb.com/tutor4dev" target="_blank" class="navbar-item is-hidden-desktop" data-v-0b4010bb><span class="icon" style="color:#4267b2;" data-v-0b4010bb><i class="fa fa-lg fa-facebook" data-v-0b4010bb></i></span></a><a href="https://www.youtube.com/user/tutor4dev/videos" target="_blank" class="navbar-item is-hidden-desktop" data-v-0b4010bb><span class="icon" style="color:#ff0000;" data-v-0b4010bb><i class="fa fa-lg fa-youtube" data-v-0b4010bb></i></span></a> <button data-target="navMenu" class="button navbar-burger false" data-v-0b4010bb><span data-v-0b4010bb></span> <span data-v-0b4010bb></span> <span data-v-0b4010bb></span></button></div> <div id="navMenu" class="navbar-menu false" data-v-0b4010bb><a href="/" class="router-link-active navbar-item is-tab" data-v-0b4010bb>หน้าหลัก</a> <!----> <!----><!----> <a href="https://www.youtube.com/user/tutor4dev/videos" target="_blank" class="navbar-item is-tab" data-v-0b4010bb>YouTube</a> <!----><a href="/articles.html" class="navbar-item is-tab is-active" data-v-0b4010bb>บทความ</a> <!----> <!----><!----> <div class="navbar-item has-dropdown is-hoverable" data-v-0b4010bb><a class="navbar-link">หลักสูตรสำหรับองค์กร</a> <div class="navbar-dropdown"><a href="/courses/laravel.html" class="navbar-item is-tab">Laravel Framework 5 Fundamental</a><a href="/courses/node.html" class="navbar-item is-tab">Node.js และ Express.js Fundamental</a><a href="/courses/react.html" class="navbar-item is-tab">React.js และ Redux Fundamental</a><a href="/courses/vue.html" class="navbar-item is-tab">Vue.js และ Vuex Fundamental</a></div></div><!----> <div class="navbar-item has-dropdown is-hoverable" data-v-0b4010bb><a class="navbar-link">คอร์สอบรม</a> <div class="navbar-dropdown"><a href="/classes/gatsby.html" class="navbar-item is-tab">React.js และ Gatsby.js 101</a><a href="/classes/react.html" class="navbar-item is-tab">React.js และ Redux 101</a><a href="/classes/vue.html" class="navbar-item is-tab">Vue.js และ Vuex 101</a></div></div><!----> <div class="navbar-item has-dropdown is-hoverable" data-v-0b4010bb><a class="navbar-link">หมวดหมู่</a> <div class="navbar-dropdown"><a href="/articles?category=configuration" class="navbar-item is-tab">Configuration</a><a href="/articles?category=firebase" class="navbar-item is-tab">Firebase</a><a href="/articles?category=javascript" class="navbar-item is-tab">JavaScript</a><a href="/articles?category=laravel" class="navbar-item is-tab">Laravel</a><a href="/articles?category=line" class="navbar-item is-tab">LINE</a><a href="/articles?category=nodejs" class="navbar-item is-tab">Node.js</a><a href="/articles?category=php" class="navbar-item is-tab">PHP</a><a href="/articles?category=python" class="navbar-item is-tab">Python</a><a href="/articles?category=reactjs" class="navbar-item is-tab">React.js</a><a href="/articles?category=vscode" class="navbar-item is-tab">Visual Studio Code</a><a href="/articles?category=vuejs" class="navbar-item is-tab">Vue.js</a><a href="/articles?category=youtube" class="navbar-item is-tab">YouTube</a></div></div><a href="/about.html" class="navbar-item is-tab" data-v-0b4010bb>เกี่ยวกับเรา</a> <!----> <!----></div></nav> <section class="section" style="padding-top:0.5em;"><div class="container"><div class="columns"><div class="column is-three-quarters"><div class="is-article"><p style="margin-bottom:2em;"></p> <div class="content custom"><h1>ใช้งาน DB Seeder และ Model Factory</h1> <p>ในการพัฒนา Database Web App การมีข้อมูลทดสอบหรือ Dummy Data มีความจำเป็นพอสมควร หากมีข้อมูลทดสอบไม่มากพอ ก็อาจทำให้การทดสอบต่างๆ ในการเขียน Web App บกพร่องตามไปด้วย Laravel ได้มีตัวช่วยที่ชื่อ DB Seeder ให้ใช้งานมาตั้งแต่ใน Laravel Version เก่า แต่ใน Version 5.1.x Laravel ได้เพิ่ม Model Factory ซึ่งยิ่งทำให้การ Seed ข้อมูลทดสอบเข้าสู่นฐานข้อมูลนั้นง่ายยิ่งขึ้นไปอีก</p> <iframe width="560" height="315" src="https://www.youtube.com/embed/vKFaKRbrhIU" frameborder="0" allowfullscreen="allowfullscreen"></iframe> <h3 id="ใช้งาน-db-seeder">ใช้งาน DB Seeder</h3> <p><em>database/seeds/DatabaseSeeder.php</em></p> <div class="language-php extra-class"><pre class="hljs"><code>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseSeeder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Seeder</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span><span class="hljs-params">()</span>
    </span>{
        Model::unguard();

        <span class="hljs-comment">// $this-&gt;call(UserTableSeeder::class);</span>
        <span class="hljs-keyword">$this</span>-&gt;command-&gt;info(<span class="hljs-string">'Hello World'</span>);

        Model::reguard();
    }
}
</code></pre></div><p>พิมพ์คำสั่งที่ <em>Terminal</em></p> <div class="language-bash extra-class"><pre class="hljs"><code>
php artisan db:seed
</code></pre></div><h3 id="สร้างไฟล์-seeder-สำหรับ-table-customer">สร้างไฟล์ Seeder สำหรับ Table Customer</h3> <p>พิมพ์คำสั่งที่ <em>Terminal</em></p> <div class="language-bash extra-class"><pre class="hljs"><code>
php artisan make:seeder CustomerTableSeeder

composer dump-autoload
</code></pre></div><p><em>database/seeds/CustomerTableSeeder.php</em></p> <div class="language-php extra-class"><pre class="hljs"><code>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerTableSeeder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Seeder</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span><span class="hljs-params">()</span>
    </span>{
        $faker = Faker\Factory::create();

        $customer = [
            <span class="hljs-string">'name'</span> =&gt; $faker-&gt;name,
            <span class="hljs-string">'email'</span> =&gt; $faker-&gt;email
        ];

        \DB::table(<span class="hljs-string">'customers'</span>)-&gt;insert($customer);
    }
}
</code></pre></div><h3 id="ใช้งาน-db-seeder-กับ-customertableseeder">ใช้งาน DB Seeder กับ CustomerTableSeeder</h3> <p><em>database/seeds/DatabaseSeeder.php</em></p> <div class="language-php extra-class"><pre class="hljs"><code>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">DatabaseSeeder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Seeder</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span><span class="hljs-params">()</span>
    </span>{
        Model::unguard();

        <span class="hljs-keyword">$this</span>-&gt;call(CustomerTableSeeder::class);

        Model::reguard();
    }
}
</code></pre></div><p>พิมพ์คำสั่งที่ <em>Terminal</em></p> <div class="language-bash extra-class"><pre class="hljs"><code>
php artisan db:seed
</code></pre></div><h3 id="ใช้งาน-model-factory">ใช้งาน Model Factory</h3> <p><em>database/factories/ModelFactory.php</em></p> <div class="language-php extra-class"><pre class="hljs"><code>
$factory-&gt;define(App\Customer::class, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Faker\Generator $faker)</span> </span>{
    <span class="hljs-keyword">return</span> [
        <span class="hljs-string">'name'</span> =&gt; $faker-&gt;name,
        <span class="hljs-string">'email'</span> =&gt; $faker-&gt;email,
    ];
});
</code></pre></div><p><em>database/seeds/CustomerTableSeeder.php</em></p> <div class="language-php extra-class"><pre class="hljs"><code>
<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CustomerTableSeeder</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Seeder</span>
</span>{
    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">run</span><span class="hljs-params">()</span>
    </span>{
        factory(<span class="hljs-string">'App\Customer'</span>, <span class="hljs-number">10</span>)-&gt;create();
    }
}
</code></pre></div><p>พิมพ์คำสั่งที่ <em>Terminal</em></p> <div class="language-bash extra-class"><pre class="hljs"><code>
php artisan db:seed
</code></pre></div><blockquote><p>Code ตัวอย่างในบทความนี้ถูกทดสอบบน Laravel 5.2.x</p></blockquote></div></div></div> <div class="column is-hidden-mobile"><p style="margin-bottom:2em"></p> <!----></div></div></div></section> <!----></div></div>
    <script src="/assets/js/app.348c05a1.js" defer></script><script src="/assets/js/15.4a80a520.js" defer></script>
  </body>
</html>
