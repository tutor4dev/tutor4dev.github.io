(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{203:function(t,s,e){"use strict";e.r(s);var i=e(1),n=Object(i.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[e("h1",[t._v("ใช้งาน LINE Notify Service")]),t._v(" "),t._m(0),t._v(" "),e("p",[t._v("บทความนี้จะเป็นนำเสนอ LINE Notify ในแบบที่ 2 หรือ เรียกว่าแบบ LINE Notify Service ตัวอย่างการนำไปประยุกต์ใช้งาน เช่น สมมุติเรามี Website ที่อยากให้มีความสามารถ ในการแจ้งข้อมูลการจัดส่งสินค้าให้ลูกค้าทราบในทุกขั้นตอนของการจัดส่งสินค้า กรณีนี้เราสามารถนำ LINE Notify Service มา Integrate กับระบบ Order Tracking ของเราเพื่อใช้ส่ง Notification ให้กับลูกค้าได้")]),t._v(" "),e("p"),t._m(1),e("p"),t._v(" "),t._m(2),t._v(" "),t._m(3),t._v(" "),e("h3",{attrs:{id:"ขั้นตอนในการ-implement-line-notify-service"}},[t._v("ขั้นตอนในการ Implement LINE Notify Service")]),t._v(" "),t._m(4),t._v(" "),t._m(5),t._v(" "),e("h3",{attrs:{id:"เพื่อนคนใหม่ชื่อคุณ-line-notify"}},[t._v("เพื่อนคนใหม่ชื่อคุณ LINE Notify")]),t._v(" "),e("p"),t._m(6),e("p"),t._v(" "),e("p",[t._v("การเพิ่มเพื่อนที่ชื่อคุณ LINE Notify เป็น Requirement ที่ขาดไม่ได้ในการใช้บริการ LINE Notify")]),t._v(" "),e("h3",{attrs:{id:"สร้าง-service-เพื่อใช้กับ-line-notify"}},[t._v("สร้าง Service เพื่อใช้กับ LINE Notify")]),t._v(" "),e("p"),t._m(7),e("p"),t._v(" "),e("p"),t._m(8),e("p"),t._v(" "),e("p"),t._m(9),e("p"),t._v(" "),e("h3",{attrs:{id:"ขั้นตอนการขออนุญาตจากผู้รับ"}},[t._v("ขั้นตอนการขออนุญาตจากผู้รับ")]),t._v(" "),e("p",[t._v("ในขั้นตอนนี้เราจะต้องสร้างลิงค์สำหรับ Redirect ไปยังระบบของ LINE Platform")]),t._v(" "),e("p",[t._v("ในขั้นตอนนี้จะต้องมีการใช้งาน Client ID ซึ่งดูได้จาก "),e("a",{attrs:{href:"https://notify-bot.line.me/my/services/",target:"_blank",rel:"noopener noreferrer"}},[t._v("หน้าจอ Manage Registered Service"),e("OutboundLink")],1),t._v(" และ ข้อมูล Parameter ที่ใช้ในการส่ง Request สามารถดูได้จาก "),e("a",{attrs:{href:"https://notify-bot.line.me/doc/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("LINE Notify API Document"),e("OutboundLink")],1)]),t._v(" "),t._m(10),t._v(" "),t._m(11),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),e("p"),t._m(21),e("p"),t._v(" "),t._m(22),t._v(" "),e("h3",{attrs:{id:"ขั้นตอนการทดสอบ-callback"}},[t._v("ขั้นตอนการทดสอบ Callback")]),t._v(" "),e("p",[t._v("หลังจบขั้นตอนการ Authentication แล้ว LINE Platform จะทำการ Redirect กลับมายัง URI ที่เราได้ระบุไว้ตอนสร้าง Service")]),t._v(" "),t._m(23),t._v(" "),t._m(24),t._m(25),t._v(" "),t._m(26),t._m(27),t._v(" "),e("h3",{attrs:{id:"ใช้งาน-postman"}},[t._v("ใช้งาน Postman")]),t._v(" "),t._m(28),t._v(" "),e("p"),t._m(29),e("p"),t._v(" "),t._m(30),t._v(" "),e("p"),t._m(31),e("p"),t._v(" "),t._m(32),t._v(" "),t._m(33),t._v(" "),t._m(34),t._v(" "),e("p",[t._v("ในขั้นตอนนี้จะต้องมีการใช้งาน Client ID และ Client Secret ซึ่งดูได้จาก "),e("a",{attrs:{href:"https://notify-bot.line.me/my/services/",target:"_blank",rel:"noopener noreferrer"}},[t._v("หน้าจอ Manage Registered Service"),e("OutboundLink")],1),t._v(" และ ข้อมูล Parameter ที่ใช้ในการส่ง Request สามารถดูได้จาก "),e("a",{attrs:{href:"https://notify-bot.line.me/doc/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("LINE Notify API Document"),e("OutboundLink")],1)]),t._v(" "),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),t._m(38),t._v(" "),t._m(39),t._m(40),t._v(" "),e("h3",{attrs:{id:"ขั้นตอนการส่ง-notification"}},[t._v("ขั้นตอนการส่ง Notification")]),t._v(" "),t._m(41),t._v(" "),e("p",[t._v("ข้อมูล Parameter ที่ใช้ในการส่ง Request สามารถดูได้จาก "),e("a",{attrs:{href:"https://notify-bot.line.me/doc/en/",target:"_blank",rel:"noopener noreferrer"}},[t._v("LINE Notify API Document"),e("OutboundLink")],1)]),t._v(" "),t._m(42),t._v(" "),t._m(43),e("p"),t._m(44),e("p"),t._v(" "),t._m(45),t._v(" "),e("h3",{attrs:{id:"つづく"}},[t._v("つづく")])])},[function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("LINE Notify มีรูปแบบบริการ 2 แบบหลักๆ แบบแรกจะเป็นลักษณะการใช้งานแบบส่วนตัว โดยการไปขอ "),s("code",[this._v("access_token")]),this._v(" จาก LINE Platform ซึ่งมีความหมายว่า เราเป็นผู้อนุญาตตัวเราเอง ให้ตัวเราเองสามารถส่ง Notification ถึงตัวเราเองได้ โดยทุกครั้งที่ส่ง Notification จะต้องใช้ "),s("code",[this._v("access_token")]),this._v(" ซึ่งเป็นเสมือนบัตรผ่านยืนยันการได้รับอนุญาตดังกล่าว")])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"https://scdn.line-apps.com/n/line_notice/img/pc/img_api_document1.png",alt:"ขั้นตอนการขอ access_token ของ LINE Notify"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("การใช้งาน LINE Notify Service ผู้ส่ง Notification คือระบบของเรา แต่ผู้รับ Notification คือลูกค้า (บุคคลอื่น) ดังนั้นการได้มาซึ่ง "),s("code",[this._v("access_token")]),this._v(" นั้นจะต้องเป็นการได้รับอนุญาต จากผู้รับ (ลูกค้า) Notication เป็นรายบุคคลเสียก่อน")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("เพื่อความเข้าใจตรงกัน การส่ง Notification ของ LINE Notify ทั้ง 2 แบบนั้น ไม่สามารถส่งตรงๆ ถึงผู้รับ (User บน LINE Platform) ได้ ดังนั้นการส่ง Notification ของ LINE Notify จะเป็นการส่งผ่านเพื่อนของผู้รับที่ชื่อว่าคุณ LINE Notify เท่านั้น และหากกลุ่มบน LINE Platform มีคุณ LINE Notify เป็นสมาชิกในกลุ่ม กลุ่มก็จะได้รับ Notification ด้วยเช่นกัน")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[t._v("ผู้ส่งใช้บัญชี LINE Developer สร้าง Service ซึ่งสามารถที่จะสร้าง Service ขึ้นมากี่ตัวก็ได้")]),t._v(" "),e("li",[t._v("Website จะต้องมีลิงค์เพื่อ Redirect ไปยังระบบ Authentication ของ LINE Platform ที่จะใช้ในการให้ผู้รับอนุญาตให้ Service ของเราสามารถส่ง Notification ให้กับผู้รับได้")]),t._v(" "),e("li",[t._v("โปรแกรม PHP เพื่อใช้รอรับ Callback จาก LINE โดยในขั้นตอนนี้ทาง LINE จะให้ "),e("code",[t._v("code")]),t._v(" หรือ อาจจะเรียกว่า "),e("code",[t._v("refresh token")]),t._v(" ตามหลักการของ "),e("code",[t._v("OAuth2")])]),t._v(" "),e("li",[t._v("โปรแกรม PHP เพื่อใช้ส่ง "),e("code",[t._v("code")]),t._v(" ไปยัง LINE Platform เพื่อเป็นการขอรับ "),e("code",[t._v("access_token")])]),t._v(" "),e("li",[t._v("โปรแกรม PHP เพื่อใช้ส่ง Notification โดยใช้ "),e("code",[t._v("access_token")]),t._v(" เสมือนเป็นตั๋วยืนยันการได้รับอนุญาต ซึ่งเราก็สามารถส่ง Notification ให้กับผู้รับคนนั้นได้เรื่อยๆ (ผ่าน LINE Notify) จนกว่า "),e("code",[t._v("access_token")]),t._v(" จะถูกยกเลิก หรือ หมดอายุ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("ผู้รับจะต้องเพิ่มเพื่อนชื่อคุณ LINE Notify ให้กับบัญชี LINE ของตัวเองเพื่อรับข้อความ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"https://scdn.line-apps.com/n/line_notice/img/pc/img_lp02_th.png?20161005",alt:"เพิ่มเพื่อน LINE Notify"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-001.png",alt:"สร้าง LINE Notify Service"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-002.png",alt:"ข้อมูล LINE Notify Service"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-003.png",alt:"Client ID และ Client Secret ของ LINE Notify Service"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ไฟล์ "),s("em",[this._v("register.php")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-php extra-class"},[e("pre",{staticClass:"hljs"},[e("code",[t._v("\n"),e("span",{staticClass:"hljs-meta"},[t._v("<?php")]),t._v("\n\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'CLIENT_ID'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'VHMNK5D2JYbYyGlJH...'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'LINE_API_URI'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'https://notify-bot.line.me/oauth/authorize?'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'CALLBACK_URI'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'http://localhost:8000/callback.php'")]),t._v(");\n\n$queryStrings = [\n    "),e("span",{staticClass:"hljs-string"},[t._v("'response_type'")]),t._v(" => "),e("span",{staticClass:"hljs-string"},[t._v("'code'")]),t._v(",\n    "),e("span",{staticClass:"hljs-string"},[t._v("'client_id'")]),t._v(" => CLIENT_ID,\n    "),e("span",{staticClass:"hljs-string"},[t._v("'redirect_uri'")]),t._v(" => CALLBACK_URI,\n    "),e("span",{staticClass:"hljs-string"},[t._v("'scope'")]),t._v(" => "),e("span",{staticClass:"hljs-string"},[t._v("'notify'")]),t._v(",\n    "),e("span",{staticClass:"hljs-string"},[t._v("'state'")]),t._v(" => "),e("span",{staticClass:"hljs-string"},[t._v("'abcdef123456'")]),t._v("\n];\n\n$queryString = LINE_API_URI . http_build_query($queryStrings);\n\n"),e("span",{staticClass:"hljs-meta"},[t._v("?>")]),t._v("\n\n<a href="),e("span",{staticClass:"hljs-string"},[t._v('"<?php echo $queryString; ?>"')]),t._v(">Register</a>\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("พิมพ์คำสั่งที่ "),s("em",[this._v("Terminal")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{staticClass:"hljs"},[s("code",[this._v("\nphp -S localhost:8000\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Start PHP Built-in Web Server ที่ Root Path ของโปรเจค")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("Browser")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{staticClass:"hljs"},[s("code",[this._v("\nhttp://localhost:8000/register.php\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/images/blogs/1711-004.png",alt:"หน้าจอ Authentication ของ LINE Platform"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("กรณีไม่มีข้อผิดพลาดเกิดขึ้น ผู้ขอรับ Notification จะถูก Redirect ไปยังระบบ Authentication หลังจาก Click ลิงค์ "),s("code",[this._v("Register")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("img",{attrs:{src:"/images/blogs/1711-005.png",alt:"เลือกห้องแชทสำหรับรับ Notification"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("หลังจากผ่านขั้นตอนการ Authentication ผู้รับจะเป็นผู้เลือกว่าจะรับ Notification แบบส่วนตัว หรือ แบบกลุ่ม")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-006.png",alt:"Notification ยืนยันการอนุญาตการส่ง Notification"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("LINE Platform ส่ง Notification ให้กับผู้รับเพื่อเป็นการยืนยันว่าผู้รับได้อนุญาตให้ Service สามารถส่ง Notification หาผู้รับได้")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("callback.php")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-php extra-class"},[s("pre",{staticClass:"hljs"},[s("code",[this._v("\n"),s("span",{staticClass:"hljs-meta"},[this._v("<?php")]),this._v("\n\nparse_str($_SERVER["),s("span",{staticClass:"hljs-string"},[this._v("'QUERY_STRING'")]),this._v("], $queries);\n\nvar_dump($queries);\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("Result")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-php extra-class"},[e("pre",{staticClass:"hljs"},[e("code",[t._v("\n"),e("span",{staticClass:"hljs-keyword"},[t._v("array")]),t._v(" (size="),e("span",{staticClass:"hljs-number"},[t._v("2")]),t._v(")\n  "),e("span",{staticClass:"hljs-string"},[t._v("'code'")]),t._v(" => string "),e("span",{staticClass:"hljs-string"},[t._v("'RMcGvWMuTS9JbLpBPWLYTk'")]),t._v(" (length="),e("span",{staticClass:"hljs-number"},[t._v("22")]),t._v(")\n  "),e("span",{staticClass:"hljs-string"},[t._v("'state'")]),t._v(" => string "),e("span",{staticClass:"hljs-string"},[t._v("'abcdef123456'")]),t._v(" (length="),e("span",{staticClass:"hljs-number"},[t._v("12")]),t._v(")\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("code")]),this._v(" และ "),s("code",[this._v("state")]),this._v(" ถูกส่งแบบ Query String พร้อมกับ Callback")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ในขั้นตอนการทดสอบ เราสามารถนำ "),s("code",[this._v("code")]),this._v(" มาขอรับ "),s("code",[this._v("access_token")]),this._v(" โดยการใช้ Postman แทนการเขียนโปรแกรม")])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-007.png",alt:"หน้าจอ Postman ขอรับ access_token"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("access_token")]),this._v(" จาก LINE Platform")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-008.png",alt:"หน้าจอ Postman ขอรับ access_token (Error)"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("code")]),this._v(" เดิมที่เคยใช้ไปแล้วไม่สามารถนำมาขอ "),s("code",[this._v("access_token")]),this._v(" ได้อีก")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"ขั้นตอนการขอ-access-token"}},[this._v("ขั้นตอนการขอ "),s("code",[this._v("access_token")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ในขั้นตอนนี้เราจะแก้ไขไฟล์ "),s("code",[this._v("callback.php")]),this._v(" เพิ่มเติมเพื่อส่ง Request ไปขอ "),s("code",[this._v("access_token")]),this._v(" แทนการใช้ Postman")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("ในการใช้งานจริงเราควรจัดเก็บ "),s("code",[this._v("access_token")]),this._v(" ในระบบฐานข้อมูล โดยจัดเก็บคู่กับ ID, email และอื่นๆของผู้รับ")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ไฟล์ "),s("em",[this._v("callback.php")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-php extra-class"},[e("pre",{staticClass:"hljs"},[e("code",[t._v("\n"),e("span",{staticClass:"hljs-meta"},[t._v("<?php")]),t._v("\n\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'CLIENT_ID'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'VHMNK5D2JYbYyGlJH...'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'CLIENT_SECRET'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'pXMb1ZOo2KO6vTnKyZtOdp8KwKHiTjJu2EhXGq...'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'LINE_API_URI'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'https://notify-bot.line.me/oauth/token'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'CALLBACK_URI'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'http://localhost:8000/callback.php'")]),t._v(");\n\nparse_str($_SERVER["),e("span",{staticClass:"hljs-string"},[t._v("'QUERY_STRING'")]),t._v("], $queries);\n\n$fields = [\n    "),e("span",{staticClass:"hljs-string"},[t._v("'grant_type'")]),t._v(" => "),e("span",{staticClass:"hljs-string"},[t._v("'authorization_code'")]),t._v(",\n    "),e("span",{staticClass:"hljs-string"},[t._v("'code'")]),t._v(" => $queries["),e("span",{staticClass:"hljs-string"},[t._v("'code'")]),t._v("],\n    "),e("span",{staticClass:"hljs-string"},[t._v("'redirect_uri'")]),t._v(" => CALLBACK_URI,\n    "),e("span",{staticClass:"hljs-string"},[t._v("'client_id'")]),t._v(" => CLIENT_ID,\n    "),e("span",{staticClass:"hljs-string"},[t._v("'client_secret'")]),t._v(" => CLIENT_SECRET\n];\n\n"),e("span",{staticClass:"hljs-keyword"},[t._v("try")]),t._v(" {\n    $ch = curl_init();\n\n    curl_setopt($ch, CURLOPT_URL, LINE_API_URI);\n    curl_setopt($ch, CURLOPT_POST, count($fields));\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $fields);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, "),e("span",{staticClass:"hljs-keyword"},[t._v("true")]),t._v(");\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, "),e("span",{staticClass:"hljs-keyword"},[t._v("false")]),t._v(");\n\n    $res = curl_exec($ch);\n    curl_close($ch);\n\n    "),e("span",{staticClass:"hljs-keyword"},[t._v("if")]),t._v(" ($res == "),e("span",{staticClass:"hljs-keyword"},[t._v("false")]),t._v(")\n        "),e("span",{staticClass:"hljs-keyword"},[t._v("throw")]),t._v(" "),e("span",{staticClass:"hljs-keyword"},[t._v("new")]),t._v(" "),e("span",{staticClass:"hljs-keyword"},[t._v("Exception")]),t._v("(curl_error($ch), curl_errno($ch));\n\n    $json = json_decode($res);\n\n    var_dump($json);\n} "),e("span",{staticClass:"hljs-keyword"},[t._v("catch")]),t._v("("),e("span",{staticClass:"hljs-keyword"},[t._v("Exception")]),t._v(" $e) {\n    var_dump($e);\n}\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("em",[this._v("Result")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-php extra-class"},[e("pre",{staticClass:"hljs"},[e("code",[t._v("\nobject(stdClass)["),e("span",{staticClass:"hljs-number"},[t._v("1")]),t._v("]\n  "),e("span",{staticClass:"hljs-keyword"},[t._v("public")]),t._v(" "),e("span",{staticClass:"hljs-string"},[t._v("'status'")]),t._v(" => int "),e("span",{staticClass:"hljs-number"},[t._v("200")]),t._v("\n  "),e("span",{staticClass:"hljs-keyword"},[t._v("public")]),t._v(" "),e("span",{staticClass:"hljs-string"},[t._v("'message'")]),t._v(" => string "),e("span",{staticClass:"hljs-string"},[t._v("'access_token is issued'")]),t._v(" (length="),e("span",{staticClass:"hljs-number"},[t._v("22")]),t._v(")\n  "),e("span",{staticClass:"hljs-keyword"},[t._v("public")]),t._v(" "),e("span",{staticClass:"hljs-string"},[t._v("'access_token'")]),t._v(" => string "),e("span",{staticClass:"hljs-string"},[t._v("'P0ku2DjIlLItSPfQhCOtNj0OJpEA7qOLH2YfaC...'")]),t._v(" (length="),e("span",{staticClass:"hljs-number"},[t._v("43")]),t._v(")\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[s("code",[this._v("access_token")]),this._v(" จาก LINE Platform เพื่อนำไปใช้ในการส่ง Notification ให้กับผู้รับต่อไป")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ในขั้นตอนนี้เราจะทำการเขียนโปรแกรม เพื่อส่ง Notification ไปยังผู้รับ ซึ่งเราสามารถส่ง Notification ให้กับผู้รับได้เรื่อยๆ จนกว่า "),s("code",[this._v("access_token")]),this._v(" จะถูกยกเลิก หรือ หมดอายุ")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("ไฟล์ "),s("em",[this._v("notify.php")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-php extra-class"},[e("pre",{staticClass:"hljs"},[e("code",[t._v("\n"),e("span",{staticClass:"hljs-meta"},[t._v("<?php")]),t._v("\n\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'ACCESS_TOKEN'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'P0ku2DjIlLItSPfQhCOtNj0OJpEA7qOLH2YfaC...'")]),t._v(");\ndefine("),e("span",{staticClass:"hljs-string"},[t._v("'LINE_API_URI'")]),t._v(", "),e("span",{staticClass:"hljs-string"},[t._v("'https://notify-api.line.me/api/notify'")]),t._v(");\n\n$headers = [\n    "),e("span",{staticClass:"hljs-string"},[t._v("'Authorization: Bearer '")]),t._v(" . ACCESS_TOKEN\n];\n$fields = [\n    "),e("span",{staticClass:"hljs-string"},[t._v("'message'")]),t._v(" => "),e("span",{staticClass:"hljs-string"},[t._v("'Your order #12345 has been delivered'")]),t._v("\n];\n\n"),e("span",{staticClass:"hljs-keyword"},[t._v("try")]),t._v(" {\n    $ch = curl_init();\n\n    curl_setopt($ch, CURLOPT_URL, LINE_API_URI);\n    curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);\n    curl_setopt($ch, CURLOPT_POST, count($fields));\n    curl_setopt($ch, CURLOPT_POSTFIELDS, $fields);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, "),e("span",{staticClass:"hljs-keyword"},[t._v("true")]),t._v(");\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, "),e("span",{staticClass:"hljs-keyword"},[t._v("false")]),t._v(");\n\n    $res = curl_exec($ch);\n    curl_close($ch);\n\n    "),e("span",{staticClass:"hljs-keyword"},[t._v("if")]),t._v(" ($res == "),e("span",{staticClass:"hljs-keyword"},[t._v("false")]),t._v(")\n        "),e("span",{staticClass:"hljs-keyword"},[t._v("throw")]),t._v(" "),e("span",{staticClass:"hljs-keyword"},[t._v("new")]),t._v(" "),e("span",{staticClass:"hljs-keyword"},[t._v("Exception")]),t._v("(curl_error($ch), curl_errno($ch));\n\n    $json = json_decode($res);\n    $status = $json->status;\n\n    var_dump($status);\n} "),e("span",{staticClass:"hljs-keyword"},[t._v("catch")]),t._v(" ("),e("span",{staticClass:"hljs-keyword"},[t._v("Exception")]),t._v(" $e) {\n    var_dump($e);\n}\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("figure",{staticClass:"image"},[s("img",{attrs:{src:"/images/blogs/1711-009.png",alt:"Notification จาก Service"}})])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("ผู้รับได้รับ Notification จาก Service เป็นที่เรียบร้อย")])])}],!1,null,null,null);s.default=n.exports}}]);